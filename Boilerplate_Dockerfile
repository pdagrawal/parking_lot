FROM ruby:2.7.1

ENV APP_HOME /binaryon
ENV RACK_ENV production
ENV RAILS_ENV production
RUN apt-get update && apt-get install -y nodejs

RUN curl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | apt-key add - && \
    echo "deb https://dl.yarnpkg.com/debian/ stable main" | tee /etc/apt/sources.list.d/yarn.list && \
    apt update && \
    apt install yarn -y && \
    curl -L https://yt-dl.org/downloads/latest/youtube-dl -o /usr/local/bin/youtube-dl

RUN mkdir $APP_HOME
WORKDIR $APP_HOME

COPY Gemfile* $APP_HOME/
RUN gem install bundler && bundle install
RUN yarn install

# To build this custom image
# docker build -f Boilerplate_Dockerfile -t binaryon_boilerplate:1 .
